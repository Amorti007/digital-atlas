<div class="info-header text-center fade-in mb-4">
  <h1
    class="display-6 fw-bold"
    style="color: var(--ana-renk)"
    data-lang="map_header_title"
  >
    Dünya Nüfus ve İstatistik Atlası
  </h1>
  <p class="lead fs-6" data-lang="map_header_desc">
    Ülkelerin üzerine gelerek temel bilgilere, tıklayarak detaylı verilere
    ulaşabilirsiniz.
  </p>
</div>
<div class="w-100 px-3 px-md-4 mb-3 fade-in" style="z-index: 1002">
  <button
    id="tools-btn"
    class="btn w-100 shadow-sm py-1 border-0"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#toolsMenu"
    aria-expanded="false"
    aria-controls="toolsMenu"
    style="
      height: 30px;
      line-height: 1;
      background-color: var(--ana-renk);
      color: var(--zemin-rengi);
    "
  >
    <i id="toggleIcon" class="fas fa-chevron-down small transition-icon"></i>
  </button>

  <div class="collapse mt-0" id="toolsMenu">
    <div
      class="card card-body shadow-sm border-0 rounded-top-0 rounded-bottom-4 backdrop-blur"
      style="background-color: var(--ikincil-renk); color: #333"
    >
      <div class="container-fluid px-0">
        <div class="row g-0">
          <div
            class="col-lg-4 col-md-12 border-end border-dark border-opacity-10 p-3 text-start position-relative"
          >
            <label
              class="small fw-bold mb-2 opacity-75 d-block"
              data-lang="tool_search_label"
            >
              <i class="fas fa-search me-1"></i>Ülke Ara
            </label>

            <div class="position-relative">
              <div class="input-group input-group-sm">
                <span
                  class="input-group-text bg-transparent border-dark border-opacity-25 border-end-0 text-dark"
                >
                  <i class="fas fa-globe"></i>
                </span>
                <input
                  type="text"
                  id="country-search"
                  class="form-control bg-transparent border-dark border-opacity-25 border-start-0 ps-0 text-dark placeholder-dark"
                  data-lang-placeholder="tool_search_ph"
                  placeholder="Türkiye, Almanya..."
                  autocomplete="off"
                  oninput="this.classList.remove('is-invalid'); document.getElementById('search-error-msg').style.display='none';"
                  onkeydown="if(event.key === 'Enter') searchCountry()"
                />
                <button
                  class="btn btn-outline-dark border-opacity-25"
                  type="button"
                  onclick="searchCountry()"
                  data-lang="tool_search_btn"
                >
                  Bul
                </button>
              </div>

              <div id="search-error-msg" class="search-feedback"></div>

              <div
                id="search-suggestions"
                class="list-group position-absolute w-100 shadow mt-1 overflow-hidden"
                style="
                  z-index: 1050;
                  display: none;
                  max-height: 300px;
                  overflow-y: auto;
                  border-radius: 0.5rem;
                  left: 0;
                  top: 100%;
                "
              ></div>
            </div>
          </div>

          <div
            class="col-lg-2 col-md-4 border-end border-dark border-opacity-10 p-3 text-start"
          >
            <label
              class="small fw-bold mb-2 opacity-75 d-block"
              data-lang="tool_filter_label"
            >
              <i class="fas fa-filter me-1"></i>Bölge Filtrele
            </label>
            <div class="d-flex flex-column gap-1">
              <div
                class="form-check d-flex align-items-center gap-2 mb-0 min-h-0"
              >
                <input
                  class="form-check-input mt-0"
                  type="radio"
                  name="mapFilter"
                  id="filterAll"
                  value="all"
                  checked
                  style="accent-color: var(--ana-renk)"
                />
                <label
                  class="form-check-label small lh-1 pt-1"
                  for="filterAll"
                  data-lang="tool_filter_all"
                  >Tümü</label
                >
              </div>
              <div
                class="form-check d-flex align-items-center gap-2 mb-0 min-h-0"
              >
                <input
                  class="form-check-input mt-0"
                  type="radio"
                  name="mapFilter"
                  id="filterEU"
                  value="eu"
                  style="accent-color: var(--ana-renk)"
                />
                <label
                  class="form-check-label small lh-1 pt-1"
                  for="filterEU"
                  data-lang="tool_filter_eu"
                  >Avrupa</label
                >
              </div>
              <div
                class="form-check d-flex align-items-center gap-2 mb-0 min-h-0"
              >
                <input
                  class="form-check-input mt-0"
                  type="radio"
                  name="mapFilter"
                  id="filterAsia"
                  value="asia"
                  style="accent-color: var(--ana-renk)"
                />
                <label
                  class="form-check-label small lh-1 pt-1"
                  for="filterAsia"
                  data-lang="tool_filter_asia"
                  >Asya</label
                >
              </div>
              <div
                class="form-check d-flex align-items-center gap-2 mb-0 min-h-0"
              >
                <input
                  class="form-check-input mt-0"
                  type="radio"
                  name="mapFilter"
                  id="filterPop"
                  value="pop100"
                  style="accent-color: var(--ana-renk)"
                />
                <label
                  class="form-check-label small lh-1 pt-1"
                  for="filterPop"
                  data-lang="tool_filter_pop"
                  >Nüfus > 100M</label
                >
              </div>
            </div>
          </div>

          <div class="col-lg-6 col-md-8 p-3 text-start">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <label
                class="small fw-bold opacity-75 mb-0"
                data-lang="tool_layers_label"
              >
                <i class="fas fa-layer-group me-1"></i>Gösterilecek Veriler
              </label>
              <button
                class="btn btn-link btn-sm p-0 text-muted text-decoration-none opacity-75"
                style="font-size: 0.7rem"
                onclick="if(typeof resetSwitches === 'function') resetSwitches()"
              >
                <i class="fas fa-undo me-1"></i>Reset
              </button>
            </div>

            <div class="row g-2">
              <div class="col-6">
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showGeo"
                    checked
                    style="accent-color: var(--ana-renk)"
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showGeo"
                    data-lang="tool_layer_geo"
                    >Coğrafya</label
                  >
                </div>
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showDemo"
                    checked
                    style="accent-color: var(--ana-renk)"
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showDemo"
                    data-lang="tool_layer_demo"
                    >Nüfus</label
                  >
                </div>
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showEco"
                    checked
                    style="accent-color: var(--ana-renk)"
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showEco"
                    data-lang="tool_layer_eco"
                    >Ekonomi</label
                  >
                </div>
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showMil"
                    checked
                    style="accent-color: var(--ana-renk)"
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showMil"
                    data-lang="tool_layer_mil"
                    >Askeri</label
                  >
                </div>
              </div>

              <div class="col-6">
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showSocioeconomics"
                    style="accent-color: var(--ana-renk)"
                    disabled
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showSocioeconomics"
                    data-lang="tool_layer_socio"
                    >Sosyo-Ekonomik</label
                  >
                </div>
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showEnvironment"
                    style="accent-color: var(--ana-renk)"
                    disabled
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showEnvironment"
                    data-lang="tool_layer_env"
                    >Enerji & Çevre</label
                  >
                </div>
                <div
                  class="form-check form-switch d-flex align-items-center gap-2 mb-1 ps-0"
                >
                  <input
                    class="form-check-input ms-0 mt-0"
                    type="checkbox"
                    id="showTechnology"
                    style="accent-color: var(--ana-renk)"
                    disabled
                  />
                  <label
                    class="form-check-label small lh-1 pt-1"
                    for="showTechnology"
                    data-lang="tool_layer_tech"
                    >Teknoloji & Altyapı</label
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="map-container" class="position-relative">
  <div class="btn-group-vertical position-absolute top-0 end-0 mt-2 me-2 z-3">
    <button
      class="btn btn-sm btn-light border shadow-sm"
      onclick="zoomMap(1.2)"
    >
      <i class="fas fa-plus"></i>
    </button>
    <button
      class="btn btn-sm btn-light border shadow-sm"
      onclick="zoomMap(0.8)"
    >
      <i class="fas fa-minus"></i>
    </button>
    <button
      class="btn btn-sm btn-warning text-white border shadow-sm"
      onclick="resetMap()"
    >
      <i class="fas fa-compress"></i>
    </button>
  </div>

  <div
    id="compare-ui-container"
    class="position-absolute bottom-0 start-50 translate-middle-x z-3"
    style="width: auto; min-width: 320px; display: none"
  >
    <div class="d-flex justify-content-center">
      <button
        class="btn btn-sm shadow-sm border rounded-top-4 rounded-bottom-0 border-bottom-0 px-4 py-0 d-flex align-items-center justify-content-center"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#compareTray"
        aria-expanded="true"
        aria-controls="compareTray"
        style="
          height: 24px;
          background-color: var(--ana-renk);
          color: var(--zemin-rengi);
        "
      >
        <i
          id="compareIcon"
          class="fas fa-chevron-down"
          style="font-size: 0.7rem"
        ></i>
        <span
          class="ms-2 fw-bold"
          style="font-size: 0.7rem"
          data-lang="tray_header_title"
          >KARŞILAŞTIR</span
        >
      </button>
    </div>

    <div id="compareTray" class="collapse show">
      <div
        class="card card-body border-0 shadow-lg rounded-4 rounded-top-0 mt-0 backdrop-blur p-2"
        style="background-color: rgba(255, 255, 255, 0.95)"
      >
        <div
          id="comparison-list"
          class="d-flex gap-2 align-items-center justify-content-center flex-wrap"
        ></div>
      </div>
    </div>
  </div>

  <div
    id="svg-placeholder"
    class="d-flex justify-content-center align-items-center w-100 h-100"
  >
    <div class="spinner-border text-secondary" role="status">
      <span class="visually-hidden">Harita Yükleniyor...</span>
    </div>
  </div>
</div>

<div class="modal fade" id="comparisonModal" tabindex="-1" aria-hidden="true">
  <div
    class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
  >
    <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
      <div
        class="modal-header border-0 text-white"
        style="background-color: var(--ana-renk)"
      >
        <h5 class="modal-title fw-bold">
          <i class="fas fa-balance-scale me-2"></i>
          <span data-lang="modal_compare_title">Karşılaştırma Tablosu</span>
        </h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body p-0">
        <div id="comparison-table-container" class="table-responsive"></div>
      </div>
      <div class="modal-footer border-0 py-2">
        <button
          type="button"
          class="btn btn-sm btn-secondary rounded-pill"
          data-bs-dismiss="modal"
          data-lang="modal_btn_close"
        >
          Kapat
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="toast-container position-fixed top-0 start-50 translate-middle-x p-3"
  style="z-index: 1100"
>
  <div
    id="notificationToast"
    class="toast align-items-center text-bg-danger border-0 shadow-lg rounded-4"
    role="alert"
    aria-live="assertive"
    aria-atomic="true"
  >
    <div class="d-flex">
      <div class="toast-body d-flex align-items-center">
        <i id="toast-icon" class="fas fa-exclamation-circle me-2 fs-5"></i>
        <span id="notificationMsg" class="fw-medium">Mesaj buraya gelecek</span>
      </div>
      <button
        type="button"
        class="btn-close btn-close-white me-2 m-auto"
        data-bs-dismiss="toast"
        aria-label="Close"
      ></button>
    </div>
  </div>
</div>